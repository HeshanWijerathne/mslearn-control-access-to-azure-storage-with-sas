@page
@model ExternalModel
@{
    ViewData["Title"] = "External companies";
}
<h1>@ViewData["Title"]</h1>

<div class="container">
    <p>Enter patient number to retrieve scanned images.</p>
    <div class="row mt-3">
        <form id="getPatientImage">
        <div class="form-group">
            <label for="patientID">Patient reference</label>
            <input type="text" class="form-control" id="patientID" aria-describedby="help" placeholder="patient-nnnnnn">
            <small id="help" class="form-text text-muted">Ensure you have been given a vaild id.</small>
        </div>
        <div class="form-check mb-5">
            <input type="checkbox" class="form-check-input" id="requestAccess">
            <label class="form-check-label" for="requestAccess">Request 5 minutes access</label>
        </div>
        <button id="btn-submit" type="submit" class="btn btn-primary">Submit</button>
        </form>
    </div>
    <div class="row mt-5">
        <div id="result" role="alert"></div>
    </div>
</div>

<script>
    $(function () {
        $('#getPatientImage').submit(function(e) {
            e.preventDefault();
            $('#result').empty();
            $('#result').removeClass();

            if ($('#requestAccess').is(':checked')) {
                $.get('api/PatientRecords/' + $('#patientID').val() + '/secure', function (data) {
                    $('#result').html('<img src="' + data.imageURI + '" class="" alt="brain scan" //>');
                    $('#result').addClass("alert alert-success");
                }, 'json');
            } else {
                $.get('api/PatientRecords/' + $('#patientID').val(), function (data) {
                    $('#result').html('<img src="' + data.imageURI + '" class="" alt="brain scan" //>');
                    $('#result').addClass("alert alert-danger");
                }, 'json');
            }
        });
    });
</script>